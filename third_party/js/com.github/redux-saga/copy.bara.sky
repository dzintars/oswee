# Update these references to your orginzations repos
originUrl = "https://github.com/redux-saga/redux-saga.git"
targetUrl = "git@github.com:dzintars/prime.git"

core.workflow(
    name = "default",
    mode = "SQUASH",

    origin = git.origin(
        url = originUrl,
        ref = "master",
    ),

    # Change path to the folder you want to publish publicly
    origin_files = glob(
      include = [
        "**"
        ],
      exclude = [
        ".changeset/**",
        ".github/**",
        ]
    ),

    destination = git.destination(
        url = targetUrl,
        fetch = "copybara-1",
        push = "copybara-1",
    ),

    # destination = git.destination(
    #     url = "file://third_party/js/com.github/redux-saga",
    #     fetch = "copybara",
    #     push = "copybara",
    # ),

    destination_files = glob(
        # Copy all files from the root
        include = ["third_party/js/com.github/redux-saga/**"],
        #  Don't remove a copy.bara.sky file if it exists.
        exclude = [
            "third_party/js/com.github/redux-saga/copy.bara.sky",
            "third_party/js/com.github/redux-saga/patches/**",
            # "third_party/js/com.github/redux-saga/.changeset",
            # "third_party/js/com.github/redux-saga/.github",
        ],
    ),

    authoring = authoring.pass_thru("dzintars <dzintars.klavins@gmail.com>"),

    # Change the path here to the folder you want to publish publicly
    transformations = [
        # Rename files or folders?
        # core.replace(
        #   before = "//third_party/bazel/bashunit",
        #   after = "//another/path:bashunit",
        #   paths = glob(["**/BUILD"]),
        # ),

        # Copy all files from the root into third_party/....
        core.move("", "third_party/js/com.github/redux-saga"),
    ],
)
