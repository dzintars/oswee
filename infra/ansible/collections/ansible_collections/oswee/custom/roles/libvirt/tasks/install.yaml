---
# tasks file for Libvirt

- name: install | Define Storage
  community.libvirt.virt_pool:
    command: define
    uri: '{{ virsh_uri }}'
    name: storename
    xml: '{{ lookup("template", "storage/pool.xml.j2") }}'

- name: install | Load Storage
  community.libvirt.virt_pool:
    command: info
    uri: '{{ virsh_uri }}'
  register: storage_pools

# - name: install | Print Storage Info
#   ansible.builtin.debug:
#     msg: Storage info {{ storage_pools.pools }}

# - name: install | Undefine default network
#   community.libvirt.virt_net:
#     command: undefine
#     name: default
#     uri: "xen:///"

# - name: install | Redefine default network
#   community.libvirt.virt_net:
#     command: define
#     name: default
#     xml: '{{ lookup("file", "net-default.xml") }}'
#     uri: "xen:///"

# - name: install | Start default network
#   community.libvirt.virt_net:
#     name: default
#     state: active
#     autostart: yes
#     uri: "xen:///"
...
