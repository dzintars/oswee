---
# tasks file for Libvirt

- name: pool | Define Storage
  community.libvirt.virt_pool:
    command: define
    uri: '{{ connection_uri }}'
    name: '{{ pool_name }}'
    xml: '{{ lookup("template", "storage/raptor.xml.j2") }}'

# - name: pool | Get XML data of a specified pool
#   community.libvirt.virt_pool:
#     command: get_xml
#     name: '{{ pool_name}}'
#   register: raptor
#
# - name: pool | Print Storage Info
#   ansible.builtin.debug:
#     msg: Storage info {{ raptor }}
#
- name: pool | Start libvirt pool {{ pool_name }}
  community.libvirt.virt_pool:
    name: '{{ pool_name }}'
    state: active

- name: pool | Set autostart libvirt pool {{ pool_name }}
  community.libvirt.virt_pool:
    name: '{{ pool_name }}'
    autostart: true

# - name: pool | Load Storage
#   community.libvirt.virt_pool:
#     command: info
#     uri: '{{ connection_uri }}'
#   register: storage_pools

# - name: pool | Print Storage Info
#   ansible.builtin.debug:
#     msg: Storage info {{ storage_pools.pools }}
...
