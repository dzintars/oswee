---
# tasks/install.yaml file for oswee.custom.minecraft role

- name: install | Install packages
  become: true
  ansible.builtin.dnf:
    name: '{{ item }}'
    state: present
  loop: '{{ packages.redhat }}'

# TODO: This will not work!
- name: config | Ensure Games directory exists
  ansible.builtin.file:
    path: '{{ item }}'
    state: directory
    mode: '0755'
  loop:
   - { '{{ ansible_env.HOME }}/Games'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/16x16/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/24x24/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/32x32/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/48x48/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/64x64/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/96x96/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/128x128/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/256x256/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/512x512/apps'}
   - { '{{ ansible_env.HOME }}/.local/share/icons/hicolor/1024x1024/apps'}

- name: install | Download Minecraft launcher
  ansible.builtin.unarchive:
    src: https://launcher.mojang.com/download/Minecraft.tar.gz
    dest: /home/{{ minecraft_user }}/Games
    remote_src: true
    extra_opts: [--strip-components=1]  # Remove top level directory

- name: install | Create Minecraft symlink
  become: true
  ansible.builtin.file:
    src: /home/{{ minecraft_user }}/minecraft-launcher/minecraft-launcher
    path: /usr/local/bin/minecraft-launcher
    state: link
    force: true

- name: install | Copy Minecraft desktop launcher
  ansible.builtin.copy:
    src: minecraft.desktop
    dest: /home/{{ minecraft_user }}/.local/share/applications/minecraft.desktop
    mode: '0755'

- name: install | Copy Minecraft desktop icons
  ansible.builtin.copy:
    src: '{{ item.src }}'
    dest: /home/{{ minecraft_user }}/.local/share/icons/hicolor/{{ item.dest }}
    mode: '0777'
  loop:
    - { src: icons/minecraft-16.png, dest: 16x16/apps/minecraft.png }
    - { src: icons/minecraft-24.png, dest: 24x24/apps/minecraft.png }
    - { src: icons/minecraft-32.png, dest: 32x32/apps/minecraft.png }
    - { src: icons/minecraft-48.png, dest: 48x48/apps/minecraft.png }
    - { src: icons/minecraft-64.png, dest: 64x64/apps/minecraft.png }
    - { src: icons/minecraft-96.png, dest: 96x96/apps/minecraft.png }
    - { src: icons/minecraft-128.png, dest: 128x128/apps/minecraft.png }
    - { src: icons/minecraft-256.png, dest: 256x256/apps/minecraft.png }
    - { src: icons/minecraft-512.png, dest: 512x512/apps/minecraft.png }
    - { src: icons/minecraft-1024.png, dest: 1024x1024/apps/minecraft.png }
...
