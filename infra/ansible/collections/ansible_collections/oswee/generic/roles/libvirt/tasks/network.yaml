---
# network tasks file for Libvirt

- name: network | Define a new network
  community.libvirt.virt_net:
    command: define
    name: virbr0
    xml: '{{ lookup("template", "network/bridge.xml.j2") }}'

# TODO: There is some security implication by doing this. Research.
- name: network | Turn On packet forwarding
  become: true
  ansible.posix.sysctl:
    name: net.ipv4.ip_forward
    value: '1'
    sysctl_set: true

- name: network | Start a network
  community.libvirt.virt_net:
    command: create
    name: virbr0

- name: network | Autostart a network
  community.libvirt.virt_net:
    autostart: true
    name: virbr0
...
