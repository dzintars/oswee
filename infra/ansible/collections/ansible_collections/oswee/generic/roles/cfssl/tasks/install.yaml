---
# tasks file for Cfssl

- name: install | Create CFSSL direcory
  become: true
  ansible.builtin.file:
    path: '/opt/cfssl'
    state: directory
    # TODO: Ideally should be assigned to "users" group and user should be member of that group
    group: '{{ ansible_user_id }}'
    mode: '0755'
  tags:
    - cfssl.setup

- name: install | Copy CFSSL artifact binaries
  become: true
  ansible.builtin.copy:
    src: "{{ cfssl_source_dir }}/bin"
    dest: /opt/cfssl/
    remote_src: true
  tags:
    - cfssl.setup

# Use `source /etc/profile.d/cfssl.sh` to source the file
# TODO: Keep in mind that this will override the file if that is modified from the other place
- name: install | Add CFSSL to system-wide $PATH
  become: true
  ansible.builtin.copy:
    dest: /etc/profile.d/cfssl.sh
    # TODO: I don't like this. Probably need to copy binaries over.
    content: 'PATH=$PATH:/opt/cfssl/bin'
  tags:
    - cfssl.setup
...
