---
# tasks/release-install file for oswee.generic.hyprland role

# - name: install | Create temporary install directory
#   ansible.builtin.tempfile:
#     path: '{{ ansible_env.HOME }}'
#     state: directory
#     suffix: .install
#   register: temp_install_dir
#   changed_when: false

- name: release-install | Download Hyprland prebuilt release source
  ansible.builtin.unarchive:
    src: https://github.com/hyprwm/Hyprland/releases/download/v0.21.0beta/v0.21.0beta.tar.gz
    # src: '{{ hyprland_prebuilt_url }}'
    dest: /tmp
    # owner: '{{ hyprland_user }}'
    # group: '{{ hyprland_group }}'
    remote_src: true
    # Strip the top level directory
    # extra_opts: [--strip-components=1]

- name: release-install | Copy Hyprland binary
  become: true
  ansible.builtin.copy:
    src: /tmp/hyprland/Hyprland
    dest: /usr/bin
    mode: a+x
    remote_src: true

- name: release-install | Copy hyprctl binary
  become: true
  ansible.builtin.copy:
    src: /tmp/hyprland/hyprctl
    dest: /usr/bin
    mode: a+x
    remote_src: true

- name: release-install | Copy libwlroots library
  become: true
  ansible.builtin.copy:
    src: /tmp/hyprland/libwlroots.so.12032
    dest: /usr/local/lib
    owner: root
    group: root
    mode: 0755
    remote_src: true

- name: release-install | Copy Hyprland desktop entry
  become: true
  ansible.builtin.copy:
    src: /tmp/hyprland/example/hyprland.desktop
    dest: /usr/share/wayland-sessions
    mode: 0644
    remote_src: true

- name: release-install | Ensure config directory exists
  ansible.builtin.file:
    path: '{{ ansible_env.HOME }}/.config/hypr/'
    state: directory
    mode: 0755
...
