---
# tasks file for ipxe

- name: Install iPXE
  become: true
  ansible.builtin.dnf:
    name: '{{ item }}'
    state: present
  loop:
    - ipxe-bootimgs

# - name: Ensure TFTPboot directory exists
#   become: true
#   ansible.builtin.file:
#     path: /var/lib/tftpboot
#     state: directory
#     mode: '0755'

# - name: Link the image
#   become: true
#   ansible.builtin.file:
#     src: /usr/share/ipxe/undionly.kpxe
#     dest: /var/lib/tftpboot/undionly.kpxe
#     force: true
#     state: link

# - name: Copy undionly.kpxe chainboot
#   ansible.builtin.copy:
#     src: /usr/share/ipxe/undionly.kpxe
#     dest: /var/lib/tftpboot/undionly.kpxe
#     # owner: root
#     # group: root
#     mode: "0644"
#     remote_src: true

# - name: Start TFTP service
#   ansible.builtin.service:
#     name: tftp
#     state: started
#     enabled: true
...
