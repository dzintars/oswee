---
# tasks file for vagrant

- name: Install packages
  become: true
  ansible.builtin.dnf:
    name: '{{ item }}'
    state: present
  loop:
    '{{ packages.redhat }}'

- name: Install Vagrant
  become: true
  ansible.builtin.dnf:
    name: '{{ vagrant_rpm }}'
    state: present
    disable_gpg_check: true

# - name: Download Hashicorp Vagrant
#   ansible.builtin.unarchive:
#     src: '{{ vagrant_archive }}'
#     dest: /tmp
#     remote_src: true

# - name: Copy Vagrant binary
#   ansible.builtin.copy:
#     src: /tmp/vagrant
#     dest: /usr/local/bin
#     mode: a+x
#     remote_src: true

- name: Install Vagrant-Libvirt plugin
  ansible.builtin.command: vagrant plugin install vagrant-libvirt
  environment:
    CONFIGURE_ARGS: 'with-libvirt-include=/usr/include/libvirt with-libvirt-lib=/usr/lib64'
